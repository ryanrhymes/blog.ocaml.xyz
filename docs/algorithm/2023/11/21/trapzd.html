<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Extended Trapezoidal Rule | Algorithm Blog</title>
<meta name="generator" content="Jekyll v4.3.2" />
<meta property="og:title" content="Extended Trapezoidal Rule" />
<meta name="author" content="Liang Wang" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Introduction The trapezoidal rule is a numerical integration technique used to approximate the definite integral of a function. It approximates the area under a curve by dividing the area into a series of trapezoids. The trapezoidal rule is widely used in engineering, physics, and other fields that require numerical integration. Implementation The OCaml code below implements the trapezoidal rule algorithm. The function trapzd takes four arguments: f is the function to be integrated, a and b are the lower and upper bounds of the integral, and n is the number of trapezoids to be used in the approximation." />
<meta property="og:description" content="Introduction The trapezoidal rule is a numerical integration technique used to approximate the definite integral of a function. It approximates the area under a curve by dividing the area into a series of trapezoids. The trapezoidal rule is widely used in engineering, physics, and other fields that require numerical integration. Implementation The OCaml code below implements the trapezoidal rule algorithm. The function trapzd takes four arguments: f is the function to be integrated, a and b are the lower and upper bounds of the integral, and n is the number of trapezoids to be used in the approximation." />
<link rel="canonical" href="/algorithm/2023/11/21/trapzd.html" />
<meta property="og:url" content="/algorithm/2023/11/21/trapzd.html" />
<meta property="og:site_name" content="Algorithm Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-11-21T06:00:00+02:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Extended Trapezoidal Rule" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Liang Wang"},"dateModified":"2023-11-21T06:00:00+02:00","datePublished":"2023-11-21T06:00:00+02:00","description":"Introduction The trapezoidal rule is a numerical integration technique used to approximate the definite integral of a function. It approximates the area under a curve by dividing the area into a series of trapezoids. The trapezoidal rule is widely used in engineering, physics, and other fields that require numerical integration. Implementation The OCaml code below implements the trapezoidal rule algorithm. The function trapzd takes four arguments: f is the function to be integrated, a and b are the lower and upper bounds of the integral, and n is the number of trapezoids to be used in the approximation.","headline":"Extended Trapezoidal Rule","mainEntityOfPage":{"@type":"WebPage","@id":"/algorithm/2023/11/21/trapzd.html"},"url":"/algorithm/2023/11/21/trapzd.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="Algorithm Blog" /><script async src="https://www.googletagmanager.com/gtag/js?id=UA-123353217-1"></script>
<script>
  window['ga-disable-UA-123353217-1'] = window.doNotTrack === "1" || navigator.doNotTrack === "1" || navigator.doNotTrack === "yes" || navigator.msDoNotTrack === "1";
  window.dataLayer = window.dataLayer || [];
  function gtag(){window.dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123353217-1');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1868946892712371" crossorigin="anonymous"></script></head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Algorithm Blog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Extended Trapezoidal Rule</h1>
    <p class="post-meta"><time class="dt-published" datetime="2023-11-21T06:00:00+02:00" itemprop="datePublished">
        Nov 21, 2023
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <h2 id="introduction">Introduction</h2>
<p>The trapezoidal rule is a numerical integration technique used to approximate the definite integral of a function. It approximates the area under a curve by dividing the area into a series of trapezoids. The trapezoidal rule is widely used in engineering, physics, and other fields that require numerical integration.</p>

<h2 id="implementation">Implementation</h2>
<p>The OCaml code below implements the trapezoidal rule algorithm. The function <code class="language-plaintext highlighter-rouge">trapzd</code> takes four arguments: <code class="language-plaintext highlighter-rouge">f</code> is the function to be integrated, <code class="language-plaintext highlighter-rouge">a</code> and <code class="language-plaintext highlighter-rouge">b</code> are the lower and upper bounds of the integral, and <code class="language-plaintext highlighter-rouge">n</code> is the number of trapezoids to be used in the approximation.</p>

<div class="language-ocaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">let</span> <span class="n">trapzd</span> <span class="n">f</span> <span class="n">a</span> <span class="n">b</span> <span class="n">n</span> <span class="o">=</span>
  <span class="k">let</span> <span class="n">error</span> <span class="bp">()</span> <span class="o">=</span>
    <span class="k">let</span> <span class="n">s</span> <span class="o">=</span>
      <span class="nn">Printf</span><span class="p">.</span><span class="n">sprintf</span>
        <span class="s2">"trapzd requires n &gt; 0 and a &lt;= b whereas n = %i, a = %g, b = %g"</span>
        <span class="n">n</span>
        <span class="n">a</span>
        <span class="n">b</span>
    <span class="k">in</span>
    <span class="nn">Owl_exception</span><span class="p">.</span><span class="nc">INVALID_ARGUMENT</span> <span class="n">s</span>
  <span class="k">in</span>
  <span class="nn">Owl_exception</span><span class="p">.</span><span class="n">verify</span> <span class="p">(</span><span class="n">n</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">a</span> <span class="o">&lt;=</span> <span class="n">b</span><span class="p">)</span> <span class="n">error</span><span class="p">;</span>
  <span class="k">if</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span>
  <span class="k">then</span> <span class="mi">0</span><span class="o">.</span><span class="mi">5</span> <span class="o">*.</span> <span class="p">(</span><span class="n">b</span> <span class="o">-.</span> <span class="n">a</span><span class="p">)</span> <span class="o">*.</span> <span class="p">(</span><span class="n">f</span> <span class="n">a</span> <span class="o">+.</span> <span class="n">f</span> <span class="n">b</span><span class="p">)</span>
  <span class="k">else</span> <span class="p">(</span>
    <span class="k">let</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">2</span><span class="o">.</span> <span class="o">**</span> <span class="n">float_of_int</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="k">in</span>
    <span class="k">let</span> <span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span> <span class="o">-.</span> <span class="n">a</span><span class="p">)</span> <span class="o">/.</span> <span class="n">m</span> <span class="k">in</span>
    <span class="k">let</span> <span class="n">x</span> <span class="o">=</span> <span class="n">ref</span> <span class="p">(</span><span class="n">a</span> <span class="o">+.</span> <span class="p">(</span><span class="mi">0</span><span class="o">.</span><span class="mi">5</span> <span class="o">*.</span> <span class="n">d</span><span class="p">))</span> <span class="k">in</span>
    <span class="k">let</span> <span class="n">s</span> <span class="o">=</span> <span class="n">ref</span> <span class="mi">0</span><span class="o">.</span> <span class="k">in</span>
    <span class="k">for</span> <span class="n">_i</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">to</span> <span class="n">int_of_float</span> <span class="n">m</span> <span class="k">do</span>
      <span class="n">x</span> <span class="o">:=</span> <span class="o">!</span><span class="n">x</span> <span class="o">+.</span> <span class="n">d</span><span class="p">;</span>
      <span class="n">s</span> <span class="o">:=</span> <span class="o">!</span><span class="n">s</span> <span class="o">+.</span> <span class="n">f</span> <span class="o">!</span><span class="n">x</span>
    <span class="k">done</span><span class="p">;</span>
    <span class="p">(</span><span class="mi">0</span><span class="o">.</span><span class="mi">5</span> <span class="o">*.</span> <span class="n">d</span> <span class="o">*.</span> <span class="p">(</span><span class="n">f</span> <span class="n">a</span> <span class="o">+.</span> <span class="n">f</span> <span class="n">b</span><span class="p">))</span> <span class="o">+.</span> <span class="p">(</span><span class="o">!</span><span class="n">s</span> <span class="o">*.</span> <span class="n">d</span><span class="p">))</span>
</code></pre></div></div>

<p>The function first checks that <code class="language-plaintext highlighter-rouge">n</code> is greater than zero and that <code class="language-plaintext highlighter-rouge">a</code> is less than or equal to <code class="language-plaintext highlighter-rouge">b</code>. If either of these conditions is not met, an exception is raised.</p>

<p>If <code class="language-plaintext highlighter-rouge">n</code> is equal to 1, the function returns the area of a single trapezoid. Otherwise, the function computes the width of each trapezoid <code class="language-plaintext highlighter-rouge">d</code> and the midpoint of the first trapezoid <code class="language-plaintext highlighter-rouge">x</code>. It then iterates over the remaining trapezoids, computing the area of each and summing them together.</p>

<p>The final result is the sum of the areas of all the trapezoids.</p>

<h2 id="step-by-step-explanation">Step-by-step Explanation</h2>
<ol>
  <li>Verify that <code class="language-plaintext highlighter-rouge">n</code> is greater than zero and that <code class="language-plaintext highlighter-rouge">a</code> is less than or equal to <code class="language-plaintext highlighter-rouge">b</code>. If either of these conditions is not met, raise an exception.</li>
  <li>If <code class="language-plaintext highlighter-rouge">n</code> is equal to 1, return the area of a single trapezoid: <code class="language-plaintext highlighter-rouge">0.5 *. (b -. a) *. (f a +. f b)</code></li>
  <li>Compute the width of each trapezoid: <code class="language-plaintext highlighter-rouge">d = (b -. a) /. m</code>, where <code class="language-plaintext highlighter-rouge">m = 2. ** float_of_int (n - 1)</code></li>
  <li>Compute the midpoint of the first trapezoid: <code class="language-plaintext highlighter-rouge">x = ref (a +. (0.5 *. d))</code></li>
  <li>Initialize the sum of the areas of all the trapezoids to 0: <code class="language-plaintext highlighter-rouge">s = ref 0.</code></li>
  <li>Iterate over the remaining trapezoids, computing the area of each and summing them together:
    <ol>
      <li>Increment the midpoint by the width of the trapezoid: <code class="language-plaintext highlighter-rouge">x := !x +. d</code></li>
      <li>Compute the area of the trapezoid and add it to the sum: <code class="language-plaintext highlighter-rouge">s := !s +. f !x</code></li>
    </ol>
  </li>
  <li>Compute the final result: <code class="language-plaintext highlighter-rouge">(0.5 *. d *. (f a +. f b)) +. (!s *. d)</code></li>
</ol>

<h2 id="complexity-analysis">Complexity Analysis</h2>
<p>The trapezoidal rule algorithm has a time complexity of O(n), where n is the number of trapezoids used in the approximation. This is because the algorithm iterates over each trapezoid once, computing its area and summing them together.</p>

<p>The space complexity of the algorithm is O(1), because it only uses a constant amount of memory to store the variables <code class="language-plaintext highlighter-rouge">d</code>, <code class="language-plaintext highlighter-rouge">x</code>, and <code class="language-plaintext highlighter-rouge">s</code>.</p>

  </div><a class="u-url" href="/algorithm/2023/11/21/trapzd.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
        <ul class="contact-list">
          <li class="p-name">Liang Wang</li>
          <li><a class="u-email" href="mailto:liang@ocaml.xyz">liang@ocaml.xyz</a></li>
        </ul>
      </div>
      <div class="footer-col">
        <p>Explore the elegance of classic and numerical algorithms through practical OCaml implementations, unraveling their inner workings and unveiling the art and science of algorithmic programming.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"></ul>
</div>

  </div>

</footer>
</body>

</html>
