<!-- _layouts/default.html -->
<!DOCTYPE html>
<html>
<head>
  <title>Red Black Tree</title>
  
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-123353217-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-123353217-1');
  </script>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1868946892712371" crossorigin="anonymous"></script>

</head>
<body>

  <div id="main-content">
    <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Red Black Tree</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2021-01-01T18:00:00+02:00" itemprop="datePublished">Jan 1, 2021
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <h2 id="introduction">Introduction</h2>
<p>Red-black tree is a self-balancing binary search tree. It was invented in 1972 by Rudolf Bayer who called them “symmetric binary B-trees,” but acquired its modern name in a paper in 1978 by Leo J. Guibas and Robert Sedgewick. Red-black trees are often used in C++ STL (Standard Template Library) implementation of map and set.</p>

<h2 id="implementation">Implementation</h2>
<p>Here is an implementation of the red-black tree in OCaml:</p>

<div class="language-ocaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">type</span> <span class="n">color</span> <span class="o">=</span> <span class="nc">Red</span> <span class="o">|</span> <span class="nc">Black</span>  
   
<span class="k">type</span> <span class="k">'</span><span class="n">a</span> <span class="n">tree</span> <span class="o">=</span>  
  <span class="o">|</span> <span class="nc">Leaf</span>  
  <span class="o">|</span> <span class="nc">Node</span> <span class="k">of</span> <span class="n">color</span> <span class="o">*</span> <span class="k">'</span><span class="n">a</span> <span class="n">tree</span> <span class="o">*</span> <span class="k">'</span><span class="n">a</span> <span class="o">*</span> <span class="k">'</span><span class="n">a</span> <span class="n">tree</span>  
   
<span class="k">let</span> <span class="n">balance</span> <span class="o">=</span> <span class="k">function</span>  
  <span class="o">|</span> <span class="nc">Black</span><span class="o">,</span> <span class="nc">Node</span> <span class="p">(</span><span class="nc">Red</span><span class="o">,</span> <span class="nc">Node</span> <span class="p">(</span><span class="nc">Red</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="n">x</span><span class="o">,</span> <span class="n">b</span><span class="p">)</span><span class="o">,</span> <span class="n">y</span><span class="o">,</span> <span class="n">c</span><span class="p">)</span><span class="o">,</span> <span class="n">z</span><span class="o">,</span> <span class="n">d</span>  
  <span class="o">|</span> <span class="nc">Black</span><span class="o">,</span> <span class="nc">Node</span> <span class="p">(</span><span class="nc">Red</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="n">x</span><span class="o">,</span> <span class="nc">Node</span> <span class="p">(</span><span class="nc">Red</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">y</span><span class="o">,</span> <span class="n">c</span><span class="p">))</span><span class="o">,</span> <span class="n">z</span><span class="o">,</span> <span class="n">d</span>  
  <span class="o">|</span> <span class="nc">Black</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="n">x</span><span class="o">,</span> <span class="nc">Node</span> <span class="p">(</span><span class="nc">Red</span><span class="o">,</span> <span class="nc">Node</span> <span class="p">(</span><span class="nc">Red</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">y</span><span class="o">,</span> <span class="n">c</span><span class="p">)</span><span class="o">,</span> <span class="n">z</span><span class="o">,</span> <span class="n">d</span><span class="p">)</span>  
  <span class="o">|</span> <span class="nc">Black</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="n">x</span><span class="o">,</span> <span class="nc">Node</span> <span class="p">(</span><span class="nc">Red</span><span class="o">,</span> <span class="n">b</span><span class="o">,</span> <span class="n">y</span><span class="o">,</span> <span class="nc">Node</span> <span class="p">(</span><span class="nc">Red</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">z</span><span class="o">,</span> <span class="n">d</span><span class="p">))</span> <span class="o">-&gt;</span>  
      <span class="nc">Node</span> <span class="p">(</span><span class="nc">Red</span><span class="o">,</span> <span class="nc">Node</span> <span class="p">(</span><span class="nc">Black</span><span class="o">,</span> <span class="n">a</span><span class="o">,</span> <span class="n">x</span><span class="o">,</span> <span class="n">b</span><span class="p">)</span><span class="o">,</span> <span class="n">y</span><span class="o">,</span> <span class="nc">Node</span> <span class="p">(</span><span class="nc">Black</span><span class="o">,</span> <span class="n">c</span><span class="o">,</span> <span class="n">z</span><span class="o">,</span> <span class="n">d</span><span class="p">))</span>  
  <span class="o">|</span> <span class="n">color</span><span class="o">,</span> <span class="n">left</span><span class="o">,</span> <span class="n">value</span><span class="o">,</span> <span class="n">right</span> <span class="o">-&gt;</span> <span class="nc">Node</span> <span class="p">(</span><span class="n">color</span><span class="o">,</span> <span class="n">left</span><span class="o">,</span> <span class="n">value</span><span class="o">,</span> <span class="n">right</span><span class="p">)</span>  
   
<span class="k">let</span> <span class="k">rec</span> <span class="n">insert</span> <span class="n">x</span> <span class="o">=</span> <span class="k">function</span>  
  <span class="o">|</span> <span class="nc">Leaf</span> <span class="o">-&gt;</span> <span class="nc">Node</span> <span class="p">(</span><span class="nc">Red</span><span class="o">,</span> <span class="nc">Leaf</span><span class="o">,</span> <span class="n">x</span><span class="o">,</span> <span class="nc">Leaf</span><span class="p">)</span>  
  <span class="o">|</span> <span class="nc">Node</span> <span class="p">(</span><span class="n">color</span><span class="o">,</span> <span class="n">left</span><span class="o">,</span> <span class="n">value</span><span class="o">,</span> <span class="n">right</span><span class="p">)</span> <span class="k">as</span> <span class="n">node</span> <span class="o">-&gt;</span>  
      <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">value</span> <span class="k">then</span> <span class="n">balance</span> <span class="p">(</span><span class="n">color</span><span class="o">,</span> <span class="n">insert</span> <span class="n">x</span> <span class="n">left</span><span class="o">,</span> <span class="n">value</span><span class="o">,</span> <span class="n">right</span><span class="p">)</span>  
      <span class="k">else</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="n">value</span> <span class="k">then</span> <span class="n">balance</span> <span class="p">(</span><span class="n">color</span><span class="o">,</span> <span class="n">left</span><span class="o">,</span> <span class="n">value</span><span class="o">,</span> <span class="n">insert</span> <span class="n">x</span> <span class="n">right</span><span class="p">)</span>  
      <span class="k">else</span> <span class="n">node</span>  
</code></pre></div></div>

<p>Here, we define the type of color as either Red or Black. We also define the type of a tree as either a Leaf or a Node with a color, left subtree, value, and right subtree. The <code class="language-plaintext highlighter-rouge">balance</code> function takes a tuple and returns a balanced node. The <code class="language-plaintext highlighter-rouge">insert</code> function takes a value and a tree and returns a new tree with the value inserted in the correct position.</p>

<h2 id="step-by-step-explanation">Step-by-step Explanation</h2>
<ol>
  <li>A new node is always inserted as a red node.</li>
  <li>If the node is the root node, it is colored black.</li>
  <li>If the parent of a red node is also red, the tree is rebalanced.</li>
  <li>If a node is red, its children must be black.</li>
  <li>The black height of a subtree must be equal on both sides.</li>
  <li>When rebalancing, the red node is rotated and recolored to maintain the above properties.</li>
</ol>

<h2 id="complexity-analysis">Complexity Analysis</h2>
<p>The worst-case time complexity for insertion, deletion, and search operations in a red-black tree is O(log n), where n is the number of nodes in the tree. This is because the height of a red-black tree is always log n. The space complexity is also O(n), where n is the number of nodes in the tree, as each node requires a constant amount of memory.</p>

  </div><a class="u-url" href="/algorithm/2021/01/01/red-black-tree.html" hidden></a>
</article>

  </div>

</body>
</html>
