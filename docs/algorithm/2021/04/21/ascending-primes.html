<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Ascending Primes | Algorithm Blog</title>
<meta name="generator" content="Jekyll v4.3.2" />
<meta property="og:title" content="Ascending Primes" />
<meta name="author" content="Liang Wang" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Introduction The Ascending Primes algorithm is a program for generating an infinitely long list of ascending prime numbers. This algorithm is important in number theory and cryptography, where prime numbers are crucial. It uses an efficient implementation of the Miller-Rabin primality test to determine whether a given integer is prime. The program generates ascending integers using a nested recursive function, then tests them in ascending order until a prime number is found, at which point it adds it to the list." />
<meta property="og:description" content="Introduction The Ascending Primes algorithm is a program for generating an infinitely long list of ascending prime numbers. This algorithm is important in number theory and cryptography, where prime numbers are crucial. It uses an efficient implementation of the Miller-Rabin primality test to determine whether a given integer is prime. The program generates ascending integers using a nested recursive function, then tests them in ascending order until a prime number is found, at which point it adds it to the list." />
<link rel="canonical" href="https://blog.ocaml.xyz/algorithm/2021/04/21/ascending-primes.html" />
<meta property="og:url" content="https://blog.ocaml.xyz/algorithm/2021/04/21/ascending-primes.html" />
<meta property="og:site_name" content="Algorithm Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-04-21T22:52:39+03:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Ascending Primes" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Liang Wang"},"dateModified":"2021-04-21T22:52:39+03:00","datePublished":"2021-04-21T22:52:39+03:00","description":"Introduction The Ascending Primes algorithm is a program for generating an infinitely long list of ascending prime numbers. This algorithm is important in number theory and cryptography, where prime numbers are crucial. It uses an efficient implementation of the Miller-Rabin primality test to determine whether a given integer is prime. The program generates ascending integers using a nested recursive function, then tests them in ascending order until a prime number is found, at which point it adds it to the list.","headline":"Ascending Primes","mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.ocaml.xyz/algorithm/2021/04/21/ascending-primes.html"},"url":"https://blog.ocaml.xyz/algorithm/2021/04/21/ascending-primes.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://blog.ocaml.xyz/feed.xml" title="Algorithm Blog" /><script async src="https://www.googletagmanager.com/gtag/js?id=UA-123353217-1"></script>
<script>
  window['ga-disable-UA-123353217-1'] = window.doNotTrack === "1" || navigator.doNotTrack === "1" || navigator.doNotTrack === "yes" || navigator.msDoNotTrack === "1";
  window.dataLayer = window.dataLayer || [];
  function gtag(){window.dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-123353217-1');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1868946892712371" crossorigin="anonymous"></script></head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Algorithm Blog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Ascending Primes</h1>
    <p class="post-meta"><time class="dt-published" datetime="2021-04-21T22:52:39+03:00" itemprop="datePublished">
        Apr 21, 2021
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <h2 id="introduction">Introduction</h2>
<p>The Ascending Primes algorithm is a program for generating an infinitely long list of ascending prime numbers. This algorithm is important in number theory and cryptography, where prime numbers are crucial. It uses an efficient implementation of the Miller-Rabin primality test to determine whether a given integer is prime. The program generates ascending integers using a nested recursive function, then tests them in ascending order until a prime number is found, at which point it adds it to the list.</p>

<h2 id="implementation">Implementation</h2>

<div class="language-ocaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="c">(* Ascending Primes *)</span>

<span class="k">let</span> <span class="n">is_prime</span> <span class="n">n</span> <span class="o">=</span>
  <span class="k">let</span> <span class="k">rec</span> <span class="n">test</span> <span class="n">x</span> <span class="o">=</span>
    <span class="k">let</span> <span class="n">q</span> <span class="o">=</span> <span class="n">n</span> <span class="o">/</span> <span class="n">x</span> <span class="k">in</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="n">q</span> <span class="o">||</span> <span class="n">x</span> <span class="o">*</span> <span class="n">q</span> <span class="o">&lt;&gt;</span> <span class="n">n</span> <span class="o">&amp;&amp;</span> <span class="n">n</span> <span class="ow">mod</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&lt;&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">test</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">6</span><span class="p">)</span>
  <span class="k">in</span> <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">5</span> <span class="k">then</span> <span class="n">n</span> <span class="ow">lor</span> <span class="mi">1</span> <span class="o">=</span> <span class="mi">3</span> <span class="k">else</span> <span class="n">n</span> <span class="ow">land</span> <span class="mi">1</span> <span class="o">&lt;&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">n</span> <span class="ow">mod</span> <span class="mi">3</span> <span class="o">&lt;&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">test</span> <span class="mi">5</span>

<span class="k">let</span> <span class="n">ascending_ints</span> <span class="o">=</span>
  <span class="k">let</span> <span class="k">rec</span> <span class="n">range10</span> <span class="n">m</span> <span class="n">d</span> <span class="o">=</span> <span class="k">if</span> <span class="n">d</span> <span class="o">&lt;</span> <span class="mi">10</span> <span class="k">then</span> <span class="n">m</span> <span class="o">+</span> <span class="n">d</span> <span class="o">::</span> <span class="n">range10</span> <span class="n">m</span> <span class="p">(</span><span class="n">succ</span> <span class="n">d</span><span class="p">)</span> <span class="k">else</span> <span class="bp">[]</span> <span class="k">in</span>
  <span class="k">let</span> <span class="n">up</span> <span class="n">n</span> <span class="o">=</span> <span class="n">range10</span> <span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="mi">10</span><span class="p">)</span> <span class="p">(</span><span class="n">succ</span> <span class="p">(</span><span class="n">n</span> <span class="ow">mod</span> <span class="mi">10</span><span class="p">))</span> <span class="k">in</span>
  <span class="k">let</span> <span class="k">rec</span> <span class="n">next</span> <span class="n">l</span> <span class="o">=</span> <span class="k">if</span> <span class="n">l</span> <span class="o">=</span> <span class="bp">[]</span> <span class="k">then</span> <span class="bp">[]</span> <span class="k">else</span> <span class="n">l</span> <span class="o">@</span> <span class="n">next</span> <span class="p">(</span><span class="nn">List</span><span class="p">.</span><span class="n">concat_map</span> <span class="n">up</span> <span class="n">l</span><span class="p">)</span> <span class="k">in</span>
  <span class="n">next</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="k">let</span> <span class="bp">()</span> <span class="o">=</span>
  <span class="nn">List</span><span class="p">.</span><span class="n">filter</span> <span class="n">is_prime</span> <span class="n">ascending_ints</span>
  <span class="o">|&gt;</span> <span class="nn">List</span><span class="p">.</span><span class="n">iter</span> <span class="p">(</span><span class="nn">Printf</span><span class="p">.</span><span class="n">printf</span> <span class="s2">" %u"</span><span class="p">)</span> <span class="o">|&gt;</span> <span class="n">print_newline</span>

</code></pre></div></div>

<p>The Ascending Primes algorithm works by generating an infinite list of ascending integers, then iterating over it and testing each number for primality using the Miller-Rabin test. If a number is found to be prime, it is added to the list of primes and the program continues to the next integer in the sequence.</p>

<h2 id="step-by-step-explanation">Step-by-step Explanation</h2>
<ol>
  <li>Define a function called <code class="language-plaintext highlighter-rouge">is_prime</code> that takes an integer <code class="language-plaintext highlighter-rouge">n</code> and returns true if <code class="language-plaintext highlighter-rouge">n</code> is a prime number.</li>
  <li>The <code class="language-plaintext highlighter-rouge">is_prime</code> function uses the Miller-Rabin primality test to determine whether <code class="language-plaintext highlighter-rouge">n</code> is prime.</li>
  <li>Define a function called <code class="language-plaintext highlighter-rouge">ascending_ints</code> that generates an infinite list of ascending integers in increments of 1 to 10.</li>
  <li>The <code class="language-plaintext highlighter-rouge">ascending_ints</code> function generates ascending integers by defining a recursive function called <code class="language-plaintext highlighter-rouge">range10</code> that generates a list of integers from <code class="language-plaintext highlighter-rouge">m</code> to <code class="language-plaintext highlighter-rouge">m + 9</code>, then appending them to the result of calling <code class="language-plaintext highlighter-rouge">range10</code> again with <code class="language-plaintext highlighter-rouge">m + 10</code> and <code class="language-plaintext highlighter-rouge">d + 1</code>.</li>
  <li>The <code class="language-plaintext highlighter-rouge">ascending_ints</code> function calls <code class="language-plaintext highlighter-rouge">range10</code> with an initial value of 0 to generate the first ten integers in the sequence, then passes the result to a recursive function called <code class="language-plaintext highlighter-rouge">next</code>.</li>
  <li>The <code class="language-plaintext highlighter-rouge">next</code> function concatenates the current list with the result of mapping the <code class="language-plaintext highlighter-rouge">up</code> function over each integer in the list.</li>
  <li>The <code class="language-plaintext highlighter-rouge">up</code> function generates a list of integers from <code class="language-plaintext highlighter-rouge">n * 10 + (n mod 10) + 1</code> to <code class="language-plaintext highlighter-rouge">n * 10 + 9</code>.</li>
  <li>The <code class="language-plaintext highlighter-rouge">ascending_ints</code> function returns the result of calling <code class="language-plaintext highlighter-rouge">next</code> with the first ten integers as the initial list.</li>
  <li>Call the <code class="language-plaintext highlighter-rouge">List.filter</code> function on <code class="language-plaintext highlighter-rouge">ascending_ints</code> to create a new list of primes by filtering the integers that pass the <code class="language-plaintext highlighter-rouge">is_prime</code> test.</li>
  <li>Call the <code class="language-plaintext highlighter-rouge">List.iter</code> function on the new list of primes to print each prime number to the console.</li>
  <li>Call the <code class="language-plaintext highlighter-rouge">print_newline</code> function to insert a newline after the list of primes has been printed.</li>
</ol>

<h2 id="complexity-analysis">Complexity Analysis</h2>
<p>The <code class="language-plaintext highlighter-rouge">is_prime</code> function uses the Miller-Rabin primality test to determine whether an integer <code class="language-plaintext highlighter-rouge">n</code> is prime. The worst-case time complexity of this test is O(k log^3 n), where k is the number of iterations of the test. In practice, the test is highly optimized and runs in O(log^3 n) time on most inputs.</p>

<p>The <code class="language-plaintext highlighter-rouge">ascending_ints</code> function generates an infinite list of integers by repeatedly concatenating the current list with the result of <code class="language-plaintext highlighter-rouge">up</code>. The <code class="language-plaintext highlighter-rouge">up</code> function produces a list of ten integers, so its time complexity is O(1). The <code class="language-plaintext highlighter-rouge">ascending_ints</code> function therefore has a time complexity of O(n), where n is the number of integers in the list that are generated before filtering terminates.</p>

<p>The <code class="language-plaintext highlighter-rouge">List.filter</code> function has a time complexity of O(n) and returns a new list containing only the elements of the original list that pass the given predicate. The predicate is the <code class="language-plaintext highlighter-rouge">is_prime</code> function, so its time complexity is the same as the time complexity of the Miller-Rabin test.</p>

<p>The <code class="language-plaintext highlighter-rouge">List.iter</code> function has a time complexity of O(n) and applies a function to each element of a list. In this case, the function is <code class="language-plaintext highlighter-rouge">Printf.printf " %u"</code>, which has a time complexity of O(1) since it simply prints the integer to the console. The <code class="language-plaintext highlighter-rouge">print_newline</code> function also has a time complexity of O(1). Therefore, the overall time complexity of the program is O(n log^3 n), where n is the number of primes generated before termination.</p>

  </div><a class="u-url" href="/algorithm/2021/04/21/ascending-primes.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="https://blog.ocaml.xyz/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
        <ul class="contact-list">
          <li class="p-name">Liang Wang</li>
          <li><a class="u-email" href="mailto:liang@ocaml.xyz">liang@ocaml.xyz</a></li>
        </ul>
      </div>
      <div class="footer-col">
        <p>Explore the elegance of classic and numerical algorithms</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"></ul>
</div>

  </div>

</footer>
</body>

</html>
